{% extends "base.html" %}

{% block title %}Upload File - Information Security Lab{% endblock %}

{% block content %}
<div class="upload-container">
    <h1>Upload File</h1>
    <div class="upload-card">
        <form method="POST" action="{{ url_for('upload_file') }}" enctype="multipart/form-data">
            <div class="form-group">
                <label for="file">Select File</label>
                <input type="file" id="file" name="file" required>
            </div>
            <div class="form-group">
                <label>Allow Access to Roles (select multiple)</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" name="allowed_roles" value="user" {% if current_user.role == 'user' %}checked{% endif %}> User</label>
                    <label><input type="checkbox" name="allowed_roles" value="manager" {% if current_user.role == 'manager' %}checked{% endif %}> Manager</label>
                    <label><input type="checkbox" name="allowed_roles" value="admin" checked disabled> Admin (always included)</label>
                </div>
                <small style="color: #666; display: block; margin-top: 0.5rem;">
                    Note: Your role ({{ current_user.role }}) and admin role will be automatically added for access.
                </small>
            </div>
            <button type="submit" class="btn btn-primary">Upload and Encrypt</button>
            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Cancel</a>
        </form>
    </div>
    
    <div class="info-box">
        <h3>Security Information</h3>
        <ul>
            <li>Files are encrypted using AES-256 encryption</li>
            <li>Each file has a unique symmetric key</li>
            <li>The symmetric key is encrypted separately for each allowed role</li>
            <li>Your role ({{ current_user.role }}) is automatically added for access</li>
            <li>Admin role is always included - admins can access all files</li>
            <li>Only users with the specified roles can decrypt and access the file</li>
        </ul>
    </div>
</div>
{% endblock %}

